<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<title>Automatic First-Aid Machine</title>
</head>

<body style="font-family:Arial;text-align:center;">

<h2>Automatic First-Aid Machine</h2>

<!-- CAMERA -->
<video id="cam" width="320" height="240" autoplay playsinline></video>
<p id="status" style="color:blue;font-weight:bold;"></p>

<button onclick="startConversation()" style="font-size:16px;">
  üé§ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§¨‡•ã‡§≤‡§æ
</button>

<p id="out" style="font-size:18px;color:green;"></p>

<script>
let step = 0;
let disease = "";
let medicine = "";

/* Machine Speak (Marathi) */
function speak(text){
  let msg = new SpeechSynthesisUtterance(text);
  msg.lang = "mr-IN";
  speechSynthesis.speak(msg);
}

/* Camera ON */
navigator.mediaDevices.getUserMedia({ video:true })
.then(stream=>{
  cam.srcObject = stream;
  status.innerText = "üë§ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡•Ä ‡§Æ‡§∂‡•Ä‡§®‡§∏‡§Æ‡•ã‡§∞ ‡§ì‡§≥‡§ñ‡§≤‡•Ä ‡§ó‡•á‡§≤‡•Ä ‡§Ü‡§π‡•á";
  speak("‡§§‡•Å‡§≤‡§æ ‡§ï‡§æ‡§Ø ‡§§‡•ç‡§∞‡§æ‡§∏ ‡§π‡•ã‡§§‡•ã‡§Ø?");
});

/* Start Conversation */
function startConversation(){
  let r = new webkitSpeechRecognition();
  r.lang = "mr-IN";
  r.start();

  r.onresult = function(e){
    let text = e.results[0][0].transcript;
    out.innerHTML = "‡§§‡•Ç ‡§¨‡•ã‡§≤‡§≤‡§æ‡§∏: " + text;

    /* STEP 1: Detect Disease */
    if(step === 0){
      if(text.includes("‡§§‡§æ‡§™")){
        disease="‡§§‡§æ‡§™"; medicine="‡§™‡•Ö‡§∞‡§æ‡§∏‡§ø‡§ü‡§æ‡§Æ‡•â‡§≤";
      }
      else if(text.includes("‡§°‡•ã‡§ï‡•á")){
        disease="‡§°‡•ã‡§ï‡•á‡§¶‡•Å‡§ñ‡•Ä"; medicine="‡§™‡•á‡§®‡§ï‡§ø‡§≤‡§∞";
      }
      else if(text.includes("‡§∏‡§∞‡•ç‡§¶‡•Ä")){
        disease="‡§∏‡§∞‡•ç‡§¶‡•Ä"; medicine="‡§ï‡•ã‡§≤‡•ç‡§° ‡§ü‡•Ö‡§¨‡•ç‡§≤‡•á‡§ü";
      }
      else if(text.includes("‡§ñ‡•ã‡§ï‡§≤‡§æ")){
        disease="‡§ñ‡•ã‡§ï‡§≤‡§æ"; medicine="‡§ï‡§´ ‡§ü‡•Ö‡§¨‡•ç‡§≤‡•á‡§ü";
      }
      else if(text.includes("‡§™‡•ã‡§ü")){
        disease="‡§™‡•ã‡§ü‡§¶‡•Å‡§ñ‡•Ä"; medicine="‡§Ö‡§Å‡§ü‡•Ö‡§∏‡§ø‡§°";
      }
      else if(text.includes("‡§ú‡§ñ‡§Æ")){
        disease="‡§ú‡§ñ‡§Æ"; medicine="‡§ï‡•â‡§ü‡§® ‡§Ü‡§£‡§ø ‡§Ö‡§Å‡§ü‡§ø‡§∏‡•á‡§™‡•ç‡§ü‡§ø‡§ï";
      }
      else if(text.includes("‡§ö‡§ï‡•ç‡§ï‡§∞")){
        disease="‡§ö‡§ï‡•ç‡§ï‡§∞"; medicine="ORS";
      }
      else{
        speak("‡§°‡•â‡§ï‡•ç‡§ü‡§∞‡§æ‡§Ç‡§ö‡§æ ‡§∏‡§≤‡•ç‡§≤‡§æ ‡§ò‡•ç‡§Ø‡§æ");
        return;
      }

      step = 1;
      speak("‡§§‡•Å‡§≤‡§æ " + disease + " ‡§Ü‡§π‡•á ‡§ï‡§æ?");
    }

    /* STEP 2: Confirmation */
    else if(step === 1){
      if(text.includes("‡§π‡•ã")){
        speak("‡§Æ‡§ó " + medicine + " ‡§ò‡•ç‡§Ø‡§æ");
        out.innerHTML +=
          "<br>ü©∫ ‡§Ü‡§ú‡§æ‡§∞: " + disease +
          "<br>üíä ‡§î‡§∑‡§ß: " + medicine;
        step = 0; // reset
      }
      else{
        speak("‡§°‡•â‡§ï‡•ç‡§ü‡§∞‡§æ‡§Ç‡§ö‡§æ ‡§∏‡§≤‡•ç‡§≤‡§æ ‡§ò‡•ç‡§Ø‡§æ");
        step = 0;
      }
    }
  };
}
</script>

</body>
</html>
